# Use the official Laravel Sail runtime image
FROM sail-8.2/app

# Set the working directory
WORKDIR /var/www/html

# Copy the application code to the container
COPY . .

# Expose ports
EXPOSE 80
EXPOSE 5173

# Set environment variables
ENV WWWUSER=${WWWUSER}
ENV WWWGROUP=${WWWGROUP}
ENV LARAVEL_SAIL=1
ENV XDEBUG_MODE=${SAIL_XDEBUG_MODE:-off}
ENV XDEBUG_CONFIG=${SAIL_XDEBUG_CONFIG:-client_host=host.docker.internal}
ENV IGNITION_LOCAL_SITES_PATH=${PWD}

# The following lines are already handled by the parent image, but you can include them if needed
# USER $WWWUSER
# RUN composer install --prefer-dist --no-ansi --no-interaction --no-progress

# Specify the command to run on container startup
CMD ["php", "artisan", "serve", "--host=0.0.0.0", "--port=80"]
